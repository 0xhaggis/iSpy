#import <Foundation/Foundation.h>
#include "iSpy.class.h"
#include "iSpy.common.h"
#include "iSpy.blacklist.h"

void remove_blacklisted_classes_from_watchlist() {
	NSArray *classBlacklist = @[
		// Urban Airship http://docs.urbanairship.com/reference/libraries/ios/latest/
		@"UAAction",
		@"UAActionArguments",
		@"UAActionJSDelegate",
		@"UAActionRegistry",
		@"UAActionRegistryEntry",
		@"UAActionResult",
		@"UAActionRunner",
		@"UAActivityViewController",
		@"UAAddCustomEventAction",
		@"UAAddTagsAction",
		@"UAAggregateActionResult",
		@"UAAnalytics",
		@"UAApplicationMetrics",
		@"UAAssociatedIdentifiers",
		@"UABaseLocationProvider",
		@"UABespokeCloseView",
		@"UABeveledLoadingIndicator",
		@"UAChannelCapture",
		@"UACircularRegion",
		@"UAConfig",
		@"UACustomEvent",
		@"UADisplayInboxAction",
		@"UADisposable",
		@"UAEvent",
		@"UAInAppMessage",
		@"UAInAppMessageButtonActionBinding",
		@"UAInAppMessageControllerDefaultDelegate",
		@"UAInAppMessageView",
		@"UAInAppMessaging",
		@"UAInbox",
		@"UAInboxMessage",
		@"UAInboxMessageList",
		@"UAInboxPushHandler",
		@"UAInboxUtils",
		@"UAIncomingInAppMessageAction",
		@"UAInstallAttributionEvent",
		@"UALandingPageAction",
		@"UALandingPageOverlayController",
		@"UALocationEvent",
		@"UALocationService",
		@"UAModifyTagsAction",
		@"UAMutableUserNotificationAction",
		@"UAMutableUserNotificationCategory",
		@"UANamedUser",
		@"UAOpenExternalURLAction",
		@"UAOverlayInboxMessageAction",
		@"UAPasteboardAction",
		@"UAProximityRegion",
		@"UAPush",
		@"UARegionEvent",
		@"UARemoveTagsAction",
		@"UAShareAction",
		@"UASignificantChangeProvider",
		@"UAStandardLocationProvider",
		@"UATagUtils",
		@"UAUser",
		@"UAUserNotificationAction",
		@"UAUserNotificationCategories",
		@"UAUserNotificationCategory",
		@"UAWalletAction",
		@"UAWebViewCallData",
		@"UAWebViewDelegate",
		@"UAWhitelist",
		@"UAirship",
		@"UAAnalyticsDBManager",
		@"UASQLite",
		@"UAHTTPConnectionOperation",
		@"UADelayOperation",
		@"UAHTTPConnection",
		@"UAHTTPRequest",
		

		// Facebook Shit
		@"FBGraphObjectArray",
	    @"FBGraphObject",
	    @"FBTask",
		@"FBRequest",
		@"FBLogger",
		@"FBRequestConnection",
		@"FBRequestConnectionRetryManager",
		@"FBRequestConnectionRetryManagerAlertViewHelper",
		@"FBRequestMetadata",
		@"FBTask",
		@"FBTaskCompletionSource",

	    // Crashlytics
		@"CLSBinaryImage",
		@"CLSInternalReport",
		@"CLSBetaToken",
		@"CLSMachException",
		@"CLSFileManager",
		@"CLSAlert",
		@"CLSSignal",
		@"CLSApplication",
		@"CLSDemangleOperation",
		@"CLSProfiling",
		@"CLSWebKitSupport",
		@"CLSPackageReportOperation",
		@"CLSSerializeSymbolicatedFramesOperation",
		@"CLSProcessReportOperation",
		@"CLSHandler",
		@"CLSSettings",
		@"CLSCompactUnwind",
		@"CLSBetaController",
		@"CLSSymbolResolver",
		@"CLSCrashReportingController",
		@"CLSStackFrame",
		@"CLSContext",
		@"CLSSymbolicationOperation",
		@"CLSJavascript",
		@"CLSHost",
		@"CLSUnwind",
		@"CLSReportsController",
		@"CLSThreadState",
		@"CLSReport",
		@"CLSUnwind_arm",
		@"CLSThreadArrayOperation",
		@"CLSUnwind_x86",
		@"CLSDwarfExpressionMachine",
		@"CLSUtility",
		@"CLSBetaUpdate",
		@"CLSException",
		@"CLSAllocate",
		@"CLSFile",
		@"CLSProcess",
		@"CLSNetworkClient",
		@"CLSDataParsing",
		@"CLSDwarfUnwind",
		@"CLSUserLogging",
		@"CLSAnswersAddToCartEvent",
		@"CLSAnalyticsApplicationLifecycleEvent",
		@"CLSAnalyticsController",
		@"CLSAnswersEvent",
		@"CLSAnalyticsIdentifierGenerator",
		@"CLSAnswersCustomEvent",
		@"CLSAnalyticsMetadataEvent",
		@"CLSAnswersSignUpEvent",
		@"CLSAnswersShareEvent",
		@"CLSEventLogEvent",
		@"CLSAnswersSearchEvent",
		@"CLSAnalyticsNetworkingClient",
		@"CLSAnswersContentViewEvent",
		@"CLSAnalyticsViewControllerEvent",
		@"CLSAnalyticsEventFilter",
		@"CLSAnalyticsEvent",
		@"CLSEventLogEventFile",
		@"CLSAnalyticsMetadataController",
		@"CLSEventLogFile",
		@"CLSAnalyticsViewControllerTrackingController",
		@"CLSAnswersPurchaseEvent",
		@"CLSCompression",
		@"CLSAnalyticsTimestampGenerator",
		@"CLSAnswersPredefinedEvent",
		@"CLSAnswersRateEvent",
		@"CLSAnswersLevelEndEvent",
		@"CLSAnswersStartCheckoutEvent",
		@"CLSEventLogSessionRepository",
		@"CLSAnswersLoginEvent",
		@"CLSAnswersLevelStartEvent",
		@"CLSAnswersInviteEvent",

		// Crittercism
		@"CRDebug",
		@"CRLegacyDeviceIdFinder",
		@"CRCrashArchive",
		@"CRCrashHandler",
		@"CRTransactionSender",
		@"CRNetStatDispatch",
		@"CRNSURLSessionDelegateProxy",
		@"CRUIWebViewDelegateProxy",
		@"CRCurrentLocation",
		@"CRTransactionReporter",
		@"CRJavaScript",
		@"CREval",
		@"CRCrash",
		@"CRRawCrash",
		@"CRUIViewMonitor",
		@"CRExceptionHandler",
		@"CRStacktraceHelpers",
		@"CRMachUtils",
		@"CRJsonUtils",
		@"CRRequestState",
		@"CRParts",
		@"CRCrashConnectionHandler",
		@"CRLog",
		@"CRConnectionHandler",
		@"CRDetectedClass",
		@"CRPluginInterface",
		@"CRRequest",
		@"CRUserMetadataConnectionHandler",
		@"CRSwizzleUtils",
		@"CRAppLoadedHandler",
		@"CRNetCollector",
		@"CRBreadcrumbsArchive",
		@"CRPreferences",
		@"CRDevice",
		@"CRReachability",
		@"CRAppInfo",
		@"CRNSURLSessionProxy",
		@"CRTest",
		@"CRDateUtils",
		@"CRCurrentConnectivity",
		@"CRHelper",
		@"CRPluginException",
		@"CRBinUtils",
		@"CRStringUtils",
		@"CRThrottle",
		@"CRAppLocator",
		@"CRTransaction",
		@"CRAppRater",
		@"CRNSURLConnectionDelegateProxy",
		@"CRNSURLSessionTaskProxy",
		@"CRSequenceNumber",
		@"CRWCSessionDelegateProxy",
		@"CRBreadcrumbs",
		@"CRWKNavigationDelegateProxy",
		@"CRRateAppAlert",
		@"CRDirectoryTree",
		@"CRFilter",

		// PLCrashReporter
		@"PLCrashAsync",
		@"PLCrashAsyncAllocator",
		@"PLCrashAsyncCompactUnwindEncoding",
		@"PLCrashAsyncImageList",
		@"PLCrashAsyncMObject",
		@"PLCrashAsyncMachExceptionInfo",
		@"PLCrashAsyncMachOImage",
		@"PLCrashAsyncMachOString",
		@"PLCrashAsyncObjCSection",
		@"PLCrashAsyncSignalInfo",
		@"PLCrashAsyncSymbolication",
		@"PLCrashAsyncThread",
		@"PLCrashAsyncThread_arm",
		@"PLCrashAsyncThread_current_defs",
		@"PLCrashAsyncThread_x86",
		@"PLCrashConstants",
		@"PLCrashFeatureConfig",
		@"PLCrashFrameCompactUnwind",
		@"PLCrashFrameDWARFUnwind",
		@"PLCrashFrameStackUnwind",
		@"PLCrashFrameWalker",
		@"PLCrashHostInfo",
		@"PLCrashLogWriter",
		@"PLCrashLogWriterEncoding",
		@"PLCrashMachExceptionPort",
		@"PLCrashMachExceptionPortSet",
		@"PLCrashMachExceptionServer",
		@"PLCrashNamespace",
		@"PLCrashProcessInfo",
		@"PLCrashReport",
		@"PLCrashReportApplicationInfo",
		@"PLCrashReportBinaryImageInfo",
		@"PLCrashReportExceptionInfo",
		@"PLCrashReportFormatter",
		@"PLCrashReportMachExceptionInfo",
		@"PLCrashReportMachineInfo",
		@"PLCrashReportProcessInfo",
		@"PLCrashReportProcessorInfo",
		@"PLCrashReportRegisterInfo",
		@"PLCrashReportSignalInfo",
		@"PLCrashReportStackFrameInfo",
		@"PLCrashReportSymbolInfo",
		@"PLCrashReportSystemInfo",
		@"PLCrashReportTextFormatter",
		@"PLCrashReportThreadInfo",
		@"PLCrashReporter",
		@"PLCrashReporterConfig",
		@"PLCrashReporterNSError",
		@"PLCrashSignalHandler",
		@"PLCrashSysctl",
		@"PLCrashTestCase",
		@"PLCrashTestThread",
		@"PLCrashUncaughtExceptionHandler",

		// Flurry
		@"Flurry",
		@"FlurryAdBanner",
		@"FlurryAdInterstitial",
		@"FlurryAdNative",
		@"FlurryAdNativeAsset",
		@"FlurryAdNativeStyle",
		@"FlurryAds",
		@"FlurryAdTargeting",
		@"FlurryImageShareParameters",
		@"FlurryTextShareParameters",
		@"FlurryTumblr",
		@"FlurryWatch",

		// mParticle
		@"MPABTestDesignerChangeRequestMessage",
		@"MPABTestDesignerChangeResponseMessage",
		@"MPABTestDesignerClearRequestMessage",
		@"MPABTestDesignerClearResponseMessage",
		@"MPABTestDesignerConnection",
		@"MPABTestDesignerDeviceInfoRequestMessage",
		@"MPABTestDesignerDeviceInfoResponseMessage",
		@"MPABTestDesignerDisconnectMessage",
		@"MPABTestDesignerSnapshotRequestMessage",
		@"MPABTestDesignerSnapshotResponseMessage",
		@"MPABTestDesignerTweakRequestMessage",
		@"MPABTestDesignerTweakResponseMessage",
		@"MPAbstractABTestDesignerMessage",
		@"MPActionButton",
		@"MPAlphaMaskView",
		@"MPAppDelegateProxy",
		@"MPAppboy",
		@"MPApplication",
		@"MPApplicationStateSerializer",
		@"MPAttributeProjection",
		@"MPBOOLToNSNumberValueTransformer",
		@"MPBackendController",
		@"MPBags",
		@"MPBaseProjection",
		@"MPBgRadialGradientView",
		@"MPBreadcrumb",
		@"MPCATransform3DToNSDictionaryValueTransformer",
		@"MPCGAffineTransformToNSDictionaryValueTransformer",
		@"MPCGColorRefToNSStringValueTransformer",
		@"MPCGPointToNSDictionaryValueTransformer",
		@"MPCGRectToNSDictionaryValueTransformer",
		@"MPCGSizeToNSDictionaryValueTransformer",
		@"MPCart",
		@"MPClassDescription",
		@"MPCommand",
		@"MPCommerce",
		@"MPCommerceEvent",
		@"MPCommerceEventInstruction",
		@"MPConnector",
		@"MPConsumerInfo",
		@"MPCookie",
		@"MPCurrentState",
		@"MPCustomModule",
		@"MPCustomModulePreference",
		@"MPDataModelAbstract",
		@"MPDatabaseMigrationController",
		@"MPDateFormatter",
		@"MPDelegateInfo",
		@"MPDesignerEventBindingRequestMesssage",
		@"MPDesignerEventBindingResponseMesssage",
		@"MPDesignerTrackMessage",
		@"MPDevice",
		@"MPEmbeddedAbstract",
		@"MPEmbeddedAdjust",
		@"MPEmbeddedBranchMetrics",
		@"MPEmbeddedComScore",
		@"MPEmbeddedFilter",
		@"MPEmbeddedForesee",
		@"MPEmbeddedKahuna",
		@"MPEmbeddedKit",
		@"MPEmbeddedKitExecStatus",
		@"MPEmbeddedKochava",
		@"MPEnumDescription",
		@"MPEvent",
		@"MPEventBinding",
		@"MPEventBindingCollection",
		@"MPEventProjection",
		@"MPEventSet",
		@"MPExceptionHandler",
		@"MPForwardRecord",
		@"MPIOConsumer",
		@"MPIOConsumerPool",
		@"MPKochavaSpatialCoordinate",
		@"MPLaunchInfo",
		@"MPMediaMetadataBase",
		@"MPMediaMetadataDPR",
		@"MPMediaMetadataDigitalAudio",
		@"MPMediaMetadataOCR",
		@"MPMediaMetadataTVR",
		@"MPMediaTrack",
		@"MPMediaTrackContainer",
		@"MPMessage",
		@"MPMessageBuilder",
		@"MPMiniNotificationViewController",
		@"MPNSAttributedStringToNSDictionaryValueTransformer",
		@"MPNSNumberToCGFloatValueTransformer",
		@"MPNetworkCommunication",
		@"MPNetworkPerformance",
		@"MPNotification",
		@"MPNotificationController",
		@"MPNotificationViewController",
		@"MPObjectFilter",
		@"MPObjectIdentityProvider",
		@"MPObjectSelector",
		@"MPObjectSerializer",
		@"MPObjectSerializerConfig",
		@"MPObjectSerializerContext",
		@"MPPassThroughValueTransformer",
		@"MPPersistenceController",
		@"MPProduct",
		@"MPProductBag",
		@"MPPromotion",
		@"MPPromotionContainer",
		@"MPPropertyDescription",
		@"MPPropertySelectorDescription",
		@"MPPropertySelectorParameterDescription",
		@"MPResponseConfig",
		@"MPResponseEvents",
		@"MPSegment",
		@"MPSegmentMembership",
		@"MPSequenceGenerator",
		@"MPSession",
		@"MPSessionHistory",
		@"MPSocialNetwork",
		@"MPSocialNetworkAccount",
		@"MPStandaloneCommand",
		@"MPStandaloneMessage",
		@"MPStandaloneUpload",
		@"MPStateMachine",
		@"MPSurrogateAppDelegate",
		@"MPSurvey",
		@"MPSurveyMultipleChoiceQuestion",
		@"MPSurveyMultipleChoiceQuestionViewController",
		@"MPSurveyNavigationController",
		@"MPSurveyQuestion",
		@"MPSurveyQuestionViewController",
		@"MPSurveyTableViewCell",
		@"MPSurveyTableViewCellBackground",
		@"MPSurveyTextQuestion",
		@"MPSurveyTextQuestionViewController",
		@"MPSwizzle",
		@"MPSwizzler",
		@"MPTakeoverNotificationViewController",
		@"MPTransactionAttributes",
		@"MPTweak",
		@"MPTweakStore",
		@"MPTypeDescription",
		@"MPUIColorToNSStringValueTransformer",
		@"MPUIControlBinding",
		@"MPUIEdgeInsetsToNSDictionaryValueTransformer",
		@"MPUIFontToNSDictionaryValueTransformer",
		@"MPUIImageToNSDictionaryValueTransformer",
		@"MPUITableViewBinding",
		@"MPURLConnectionAssociate",
		@"MPURLRequestBuilder",
		@"MPUpload",
		@"MPUploadBuilder",
		@"MPUserSegments",
		@"MPVariant",
		@"MPVariantAction",
		@"MPVariantTweak",
		@"MPWebSocket",
		@"MParticle",
		@"mParticlePLCrashHostInfo",
		@"mParticlePLCrashMachExceptionPort",
		@"mParticlePLCrashMachExceptionPortSet",
		@"mParticlePLCrashMachExceptionServer",
		@"mParticlePLCrashProcessInfo",
		@"mParticlePLCrashReport",
		@"mParticlePLCrashReportApplicationInfo",
		@"mParticlePLCrashReportBinaryImageInfo",
		@"mParticlePLCrashReportExceptionInfo",
		@"mParticlePLCrashReportMachExceptionInfo",
		@"mParticlePLCrashReportMachineInfo",
		@"mParticlePLCrashReportProcessInfo",
		@"mParticlePLCrashReportProcessorInfo",
		@"mParticlePLCrashReportRegisterInfo",
		@"mParticlePLCrashReportSignalInfo",
		@"mParticlePLCrashReportStackFrameInfo",
		@"mParticlePLCrashReportSymbolInfo",
		@"mParticlePLCrashReportSystemInfo",
		@"mParticlePLCrashReportTextFormatter",
		@"mParticlePLCrashReportThreadInfo",
		@"mParticlePLCrashReporter",
		@"mParticlePLCrashReporterConfig",
		@"mParticlePLCrashSignalHandler",
		@"mParticlePLCrashUncaughtExceptionHand",
		
		// NUIParse
		@"PodsDummy_Pods_NUIParse",
		@"NUIPWhiteSpaceToken",
		@"NUIPWhiteSpaceRecogniser",
		@"NUIPTokeniser",
		@"NUIPShiftReduceAction",
		@"NUIPShiftAction",
		@"NUIPSLRParser",
		@"NUIPRule",
		@"NUIPRegexpRecogniser",
		@"NUIPRecoveryAction",
		@"NUIPTokenStream",
		@"NUIPToken",
		@"NUIPSyntaxTree",
		@"NUIPShiftReduceState",
		@"NUIPShiftReduceParser",
		@"NUIPShiftReduceGotoTable",
		@"NUIPShiftReduceActionTable",
		@"NUIPLR1Parser",
		@"NUIPLR1Item",
		@"NUIPLALR1Parser",
		@"NUIPKeywordToken",
		@"NUIPKeywordRecogniser",
		@"NUIPJSONParser",
		@"NUIPRHSItemResult",
		@"NUIPRHSItem",
		@"NUIPQuotedToken",
		@"NUIPQuotedRecogniser",
		@"NUIPParser",
		@"NUIPNumberToken",
		@"NUIPNumberRecogniser",
		@"NUIPErrorToken",
		@"NUIPEOFToken",
		@"NUIPItem",
		@"NUIPIdentifierToken",
		@"NUIPIdentifierRecogniser",
		@"NUIPGrammarSymbol",
		@"NUIPGrammar",
		@"NUIPBNFParserDelegate",
		@"NUIProgressViewRenderer",
		@"NUIParserDelegate"


	];
	iSpy *mySpy = [iSpy sharedInstance];

	NSLog(@"[iSpy blacklist] There are %ld entries in the class blacklist", (unsigned long)[classBlacklist count]);
	
	for(int bl = 0; bl < [classBlacklist count]; bl++) {
		//NSLog(@"Removing %@ from watchlist", [classBlacklist objectAtIndex:bl]);
		[mySpy msgSend_watchlistRemoveClass:[classBlacklist objectAtIndex:bl]];
	}
}
