<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>iSpy</title>
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/animate.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/local.css" />
    <link rel="stylesheet" type="text/css" href="/css/ispy.css" />
    <link rel="stylesheet" href="/css/main.css">

    <script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/js/underscore.min.js"></script>
    <script type="text/javascript" src="/js/backbone.min.js"></script>

    <!-- iSpy Application Files -->
    <script type="text/javascript" src="/js/ispy/main.js"></script>
    <script type="text/javascript" src="/js/ispy/models.js"></script>
    <script type="text/javascript" src="/js/ispy/collections.js"></script>
    <script type="text/javascript" src="/js/ispy/views.js"></script>
    <script type="text/javascript" src="/js/ispy/router.js"></script>

    <!-- you need to include the shieldui css and js assets in order for the charts to work -->
    <link rel="stylesheet" type="text/css" href="/css/shieldui-all.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/all.min.css" />
    <link id="gridcss" rel="stylesheet" type="text/css" href="/css/dark-bootstrap-all.min.css" />
    <link rel="stylesheet" href="/css/slidebars.min.css">
    <link rel="stylesheet" href="/css/slidebars-theme.css">
    <script type="text/javascript" src="/js/shieldui-all.min.js"></script>
    <script type="text/javascript" src="/js/slidebars.min.js"></script>
</head>

<!-- iSpy Templates -->
<script id="ClassDumpTemplate" type="text/template">
    Application Summary
</script>

<script id="ClassDumpTemplate" type="text/template">
    Class Dump
</script>

<script id="ObjcClassTemplate" type="text/template">
    <%= title > <button> Foobar </button>
</script>

<style>
.cycriptTerm {
    height: 600px;
}

.modal-content {
  width: 1200px;
  margin-left: -300px;
}
</style>

<script>
$(document).ready(function() {

    /* Menu Setup */
    $.slidebars();
    jQuery('ul.nav li.dropdown').hover(function() {
        jQuery(this).find('.dropdown-menu').stop(true, true).delay(200).show();
    }, function() {
        jQuery(this).find('.dropdown-menu').stop(true, true).delay(200).hide();
    });

    /* WebSocket Setup */
    var jsonrpc_url = "ws://" + window.location.host + "/jsonrpc";
    console.log("[*] Connecting to json-rpc server -> " + jsonrpc_url);
    jsonrpc = new WebSocket(jsonrpc_url);

    /* WebSocket Opened */
    jsonrpc.onopen = function() {
        console.log("[*] Successfully connected to remote rpc server!");
        $("#activity-monitor").removeClass("fa-eye-slash");
        $("#activity-monitor").addClass("fa-refresh fa-spin");
    }

    /* WebSocket Message */
    jsonrpc.onmessage = function(emit) {
        console.log(emit);
        var msg = jQuery.parseJSON(emit.data);
        if ('messageType' in msg && msg['messageType'] == "obj_msgSend") {
            add_objc_msg(msg);
        }
    }

    /* WebSocket Closed */
    jsonrpc.onclose = function() {
        console.log("[!] Connection to server lost!");
        $("#activity-monitor").removeClass("fa-refresh fa-spin");
        $("#activity-monitor").addClass("fa-eye-slash");
    }

    /* WebSocket Setup */
    var cycript_url = "ws://" + window.location.host + "/cycript";
    console.log("[*] Connecting to cycript server -> " + cycript_url);
    cycript = new WebSocket(cycript_url);

    /* WebSocket Opened */
    cycript.onopen = function() {
        console.log("[*] Successfully connected to remote cycript server!");
    }

    /* WebSocket Message */
    cycript.onmessage = function(emit) {
        console.log(emit);
    }

    /* WebSocket Closed */
    cycript.onclose = function() {
        console.log("[!] Connection to server lost!");
    }

    /* Init router and start backbone history */
    var router = new iSpy.Router;
    console.log(router);
    Backbone.history.start();


});

</script>

<body spellcheck="false">
    <div class="bf-panel" id="wrapper" style="margin-top: -40px; margin-left: -40px; padding-bottom: 20px;">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand sb-toggle-left" href="#">
                    <i class="fa fa-fw fa-bars"></i>
                </a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse ">
                <ul class="nav navbar-nav navbar-user">
                    <li class="dropdown messages-dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-fw fa-lg fa-code"></i>&nbsp;
                            Class Browser<!-- <span class="badge">2</span>-->
                        </a>
                        <ul class="dropdown-menu">
                            <li class="menu-pad"><a href="#"><i class="fa fa-fw fa-cubes fa-pad"></i>Classes</a></li>
                            <li class="menu-pad"><a href="#"><i class="fa fa-fw fa-exchange fa-pad"></i>Protocols</a></li>
                            <li class="menu-pad"><a href="#"><i class="fa fa-fw fa-cube fa-pad"></i>Instances</a></li>
                            <li class="divider"></li>
                            <li class="menu-pad"><a href="#"><i class="fa fa-fw fa-file-code-o fa-pad"></i>Generate Headers</a></li>
                        </ul>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-user">
                    <!-- <li class="divider-vertical"></li> -->
                    <li class="dropdown messages-dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-lg fa-share-alt"></i>&nbsp;
                            Call Tracing
                        </a>
                        <ul class="dropdown-menu">
                            <li class="menu-pad"><a href="#" ><i class="fa fa-fw fa-bolt fa-pad"></i>View real-time logs</a></li>
                            <li class="menu-pad"><a href="#" ><i class="fa fa-fw fa-cog fa-pad"></i>Settings</a></li>
                        </ul>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-user navbar-right">
                    <li>
                        <a href="#" ><i id="activity-monitor" class="fa fa-fw fa-eye-slash"></i></a>
                    </li>
                </ul>
            </div>
        </nav><!-- /#nav -->
    </div>
    <!-- Main -->
    <div id="sb-site" class="animated fadeIn cycriptTerm">
    This is the site.
    </div>
    
<script src="/js/main.js"></script>
                <script src="/js/ext.js"></script>
</body>
</html>
